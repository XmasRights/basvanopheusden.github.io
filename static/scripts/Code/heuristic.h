#ifndef HEURISTIC_H_INCLUDED
#define HEURISTIC_H_INCLUDED
//#define DEFAULT_WEIGHTS

#include "board.h"
#include <random>
#include <vector>
#include <map>
using namespace std;

const double params[200][10]={{2.77700,0.00378,0.34749,0.02127,0.99383,0.92899,1.09970,0.50491,4.67790,-30.79100},
{1.72630,0.00500,0.30000,0.03000,0.50840,1.10690,1.05870,0.50000,5.71990,-22.96000},
{4.40910,0.03000,0.39360,0.02000,1.00000,0.40000,0.60541,0.60000,4.66670,15.00000},
{5.38950,0.02000,0.80134,0.01000,1.16670,0.80000,1.00000,-1.10090,2.50000,15.00000},
{2.24230,0.02950,0.32214,0.01000,0.36511,0.29554,0.75000,0.23750,2.06250,13.00000},
{2.24230,0.02950,0.32214,0.01000,0.36511,0.29554,0.75000,0.23750,2.06250,13.00000},
{4.43160,0.00995,0.21924,0.02030,0.47186,0.79092,2.19600,0.30797,11.67800,-99.38500},
{5.25840,0.01044,0.40308,0.07867,1.00490,0.85608,1.00110,0.29635,3.51260,2.48720},
{3.51380,0.00595,0.25636,0.03840,0.82214,1.13720,0.95999,0.43467,4.75670,0.00000},
{4.63280,0.00528,0.23761,0.03036,1.04600,0.82598,0.82598,0.26116,5.65660,-34.76900},
{2.33930,0.00100,0.63202,0.01000,1.07390,0.19893,1.00000,0.20000,2.50000,11.66700},
{2.33930,0.00100,0.63202,0.01000,1.07390,0.19893,1.00000,0.20000,2.50000,11.66700},
{2.33930,0.00100,0.63202,0.01000,1.07390,0.19893,1.00000,0.20000,2.50000,11.66700},
{2.14900,0.00100,0.63213,0.02500,0.63320,1.56920,1.60380,-0.02786,17.80900,28.00000},
{7.00000,0.02000,0.20000,0.02000,1.15140,0.49684,0.48959,0.40000,2.50000,15.00000},
{6.71730,0.00100,0.45036,0.01000,1.64000,0.25385,1.18540,0.67065,5.87510,-4.70560},
{3.08950,0.02111,0.83085,0.01755,1.97210,0.99991,1.35980,0.25397,2.59240,14.99900},
{3.05630,0.01020,0.56754,0.01000,0.93572,0.36188,0.75934,0.38759,3.22300,15.30900},
{9.99990,0.13461,0.30000,0.01000,1.00000,0.80000,0.99999,0.30000,3.59700,6.96390},
{7.00000,0.01025,0.55000,0.02000,2.00000,1.60000,0.78194,0.40000,2.50000,15.00000},
{4.98700,0.01822,0.43244,0.01000,1.23840,1.04520,1.27240,0.23809,3.81010,12.82100},
{6.20070,0.00179,0.32963,0.01794,1.20220,0.89267,1.21410,0.33496,3.73170,-45.01100},
{3.00000,0.00647,0.30000,0.03471,1.00000,0.80000,0.99999,0.30000,2.50000,15.00000},
{5.00000,0.01254,0.80546,0.03000,1.00000,0.80000,1.60000,0.11859,3.50000,15.00000},
{3.00000,0.02000,0.20000,0.02000,1.00000,0.80000,0.68816,0.19816,2.50000,15.00000},
{10.00000,0.02351,0.47892,0.02410,2.00430,0.79312,1.13880,0.96942,3.41210,-196.27000},
{0.10000,0.00277,0.31313,0.02416,0.73203,0.62398,1.30630,0.49906,3.03590,17.45000},
{2.55000,0.01251,0.28554,0.02480,0.95228,-0.47994,0.74719,0.30000,2.50000,10.00000},
{4.18810,0.03049,0.18415,0.01083,0.99556,0.67887,0.94820,0.43481,2.13320,11.38400},
{4.73420,0.01000,0.51326,0.01000,2.00000,0.48115,1.00000,0.30000,2.50000,15.00000},
{8.00000,0.00609,0.49130,0.01000,1.13160,0.30342,0.33730,0.35312,4.55080,-34.42300},
{3.97650,0.00964,0.37337,0.01898,1.01850,-0.25638,0.50013,0.18162,3.17320,15.56000},
{3.77800,0.01564,0.28832,0.02000,1.42640,0.08295,1.00000,0.30000,2.50000,15.00000},
{4.56980,0.02868,0.20000,0.02208,1.23520,0.81423,0.92344,0.31088,2.41480,6.93510},
{3.49690,0.01879,0.39540,0.02977,0.49538,0.06105,1.30420,0.61752,3.39170,11.09200},
{0.10000,0.02490,0.18889,0.01500,0.50000,0.40000,0.61423,0.30000,2.50000,15.00000},
{3.61940,0.48747,0.16721,0.02017,1.00000,0.40000,1.11110,0.19956,4.27710,23.33300},
{5.00000,0.02000,0.19291,0.01782,1.00000,0.52859,0.75640,0.40000,2.50000,6.63090},
{5.00000,0.00528,0.40000,0.02000,1.00000,0.80000,0.48682,0.30000,3.33330,15.00000},
{5.00000,0.01000,0.20000,0.24000,1.16670,0.80000,0.33787,0.30000,2.50000,15.00000},
{7.00000,0.00796,0.20000,0.02000,0.50388,0.69421,0.63592,0.13411,2.50000,15.00000},
{7.00000,0.01050,0.54568,0.01000,2.00000,0.38997,-0.05333,-0.09590,2.50000,15.00000},
{9.68980,0.03110,0.08317,0.01416,0.25000,0.60445,0.70794,0.71905,1.98890,17.33700},
{1.47640,0.01034,0.00000,0.01000,0.53320,0.01138,0.91816,0.01457,1.56640,11.26800},
{2.65440,0.01183,0.54998,0.01947,1.14150,0.68254,1.07440,0.25752,4.95400,15.21000},
{7.00000,0.01000,0.20000,0.03000,1.00000,0.40000,0.49543,0.30000,2.50000,15.00000},
{2.29640,0.02244,0.20587,0.02000,0.74170,0.76883,0.80000,1.52950,3.50000,30.00000},
{4.72770,0.17428,0.10000,0.02000,1.19170,0.80000,1.00000,0.30000,3.33330,15.00000},
{0.10000,0.01000,0.18885,0.02000,0.50000,0.62658,0.74410,0.30006,3.61230,12.87900},
{10.00000,0.01000,0.38329,0.02666,1.99990,0.53328,0.79993,0.99994,4.99990,9.11800},
{5.00000,0.02158,0.22354,0.01000,1.00000,0.02354,0.87667,0.69759,3.15710,12.34900},
{5.00000,0.00500,0.28307,0.02000,1.20370,0.46550,1.12160,1.00000,3.50000,15.00000},
{4.74140,0.01327,0.22899,0.01000,1.68090,0.27649,0.44463,0.61712,1.62520,14.24800},
{5.65820,0.51282,0.29864,0.01972,1.03260,0.54937,0.96029,0.33111,9.26950,17.73000},
{3.22610,0.00407,0.23038,0.02232,1.10150,0.31883,0.69564,0.58696,2.70290,9.36230},
{8.93660,0.00701,0.40324,0.01137,1.72280,1.21420,0.35822,0.12947,4.39660,10.94000},
{6.44050,0.01158,0.21707,0.02018,2.25370,0.50176,0.54877,0.29096,2.49360,20.11100},
{3.16660,0.02000,0.30000,0.09737,1.00000,0.80000,0.66032,0.10000,4.00000,15.00000},
{5.05110,0.00367,0.29876,0.02035,1.00930,0.43655,0.78442,0.29731,2.46970,11.80500},
{5.11750,0.00631,0.51467,0.01920,1.13730,0.69986,1.03980,0.27411,4.80370,15.31900},
{4.43310,0.00500,0.26918,0.02000,1.04060,0.74532,1.00000,0.30000,2.82700,11.74400},
{1.46400,0.01389,0.16425,0.02879,0.77362,0.60878,0.88713,0.73042,3.44760,16.05300},
{0.10000,0.00534,0.27451,0.02544,0.50617,0.76176,0.75401,0.96814,4.08450,20.44600},
{3.00000,0.00500,0.60000,0.06000,1.16670,1.06670,1.33330,0.40000,2.50000,15.00000},
{3.64480,0.01382,0.28468,0.02012,0.98031,0.60952,1.07510,0.60399,4.98930,15.04900},
{6.76900,0.00505,0.58509,0.01000,2.94880,0.02168,0.52376,0.27402,2.81840,15.46800},
{2.11920,0.00100,0.18685,0.01000,0.25000,0.81546,1.00000,0.30000,2.50000,15.00000},
{1.24510,0.00100,0.31965,0.01626,1.01110,0.97422,0.82260,0.51336,2.46760,15.14800},
{0.10000,0.01008,0.34177,0.03044,0.98665,0.81374,1.01530,0.29008,4.97330,14.87800},
{4.14520,0.00345,0.27910,0.01527,0.98143,0.69533,0.77088,0.41742,3.77380,14.78600},
{6.23600,0.00367,0.40097,0.01756,1.01370,0.79951,0.67907,0.29921,3.54830,7.06330},
{4.63600,0.01000,0.40000,0.01000,0.99319,0.76472,1.11110,0.31111,4.66660,18.33300},
{1.02810,0.00100,0.02829,0.01000,0.56250,0.58315,0.50000,0.62500,2.75930,6.82460},
{4.02480,0.00619,0.18133,0.01576,0.50000,0.20740,1.81200,0.26331,3.90590,20.00000},
{2.47280,0.00879,0.15112,0.01895,1.14790,0.43319,0.78053,0.25644,2.40840,12.35100},
{3.56600,0.00823,0.23922,0.01000,0.91420,0.62183,1.09810,0.57354,2.32840,14.11800},
{3.00000,0.00500,0.20089,0.02000,1.00000,0.55113,1.00000,0.40000,3.47770,6.90390},
{3.00000,0.00500,0.20000,0.01971,0.99999,1.18590,1.00000,0.25282,3.33330,15.00000},
{2.51800,1.00000,0.20007,0.02462,1.05960,0.79937,0.83804,-1.05850,2.50120,14.99400},
{3.33180,0.00100,0.11146,0.01840,0.84756,0.31976,0.82293,0.37537,2.55520,7.67810},
{0.10000,0.00373,0.40000,0.01500,2.00000,1.00000,0.80000,0.30000,2.50000,15.00000},
{4.11010,0.00649,0.09853,0.01889,0.83333,0.84666,0.75062,0.40000,3.05560,12.22200},
{5.00000,0.01000,0.10000,0.03000,1.00000,0.80000,1.00000,0.50000,2.50000,15.00000},
{2.94620,0.00100,0.23698,0.04000,0.74998,0.68944,0.92159,0.39998,2.74190,15.00000},
{5.00000,0.01000,0.20000,0.02000,0.48611,1.00650,1.00000,0.40000,2.50000,15.00000},
{0.10000,0.00269,0.12540,0.02000,0.50000,0.79999,1.00000,0.41723,3.30900,30.00000},
{2.51670,0.00500,0.20000,0.01926,0.50000,0.80000,1.00000,0.60000,3.68250,21.46300},
{7.01470,0.00100,0.10223,0.01000,2.00510,1.00370,0.99635,0.30241,1.96470,14.97000},
{2.18420,0.00396,0.15959,0.02642,1.00000,0.77574,0.86667,0.31111,2.85030,15.00000},
{4.18330,0.00100,0.10000,0.02293,1.00000,0.40000,1.00000,0.30000,2.50000,20.00000},
{7.43470,0.00545,0.14275,0.02393,0.78575,0.28612,0.85687,0.26527,2.75050,13.85500},
{9.50000,0.01022,0.27340,0.02000,1.64050,0.48391,0.65803,0.30000,3.90690,58.74400},
{5.66760,0.00144,0.30000,0.02000,1.00000,1.41370,1.05630,0.30000,3.50000,15.00000},
{3.55770,0.00891,0.20169,0.03000,1.00000,0.63423,0.61971,0.30000,2.50000,20.00000},
{2.91290,0.00748,0.30319,0.02934,0.71650,0.65617,1.04470,0.32903,6.53870,17.37300},
{2.68990,0.00100,0.25000,0.03000,0.93771,0.80000,0.72400,0.40000,3.50000,15.00000},
{5.27500,0.01000,0.20000,0.03000,1.50000,0.88889,0.64181,0.22010,2.50000,20.00000},
{3.74300,0.00900,0.04807,0.01000,0.25000,1.02080,1.68200,0.42443,4.20840,17.25000},
{7.18420,0.00100,0.38940,0.03338,0.95998,1.15170,0.99558,-0.00221,3.50990,14.96500},
{3.00000,0.00300,0.20000,0.01962,0.97776,0.40000,0.86667,0.60000,2.50000,13.33300},
{7.00000,0.00593,0.23259,0.02000,1.00000,0.53334,1.00000,0.30000,5.33770,15.00000},
{7.04770,0.00100,0.20483,0.02024,0.98943,0.78912,1.01210,0.39215,3.47280,15.09700},
{5.00000,0.00100,0.30000,0.02000,1.00000,0.80000,0.80000,0.50000,2.50000,7.50690},
{4.37380,0.00102,0.19963,0.01007,0.56412,1.42500,1.58010,0.04177,3.71870,9.18550},
{9.49010,0.00624,0.39122,0.02311,1.67660,0.82792,0.96558,0.29332,5.09910,30.00000},
{3.55000,0.00236,0.20000,0.02000,1.00000,0.80000,1.00000,0.30000,2.50000,15.00000},
{5.00000,0.00122,0.19412,0.03000,0.80407,1.09320,1.50000,0.30000,2.50000,10.00000},
{4.00000,0.00100,0.10075,0.03500,0.42139,0.72542,1.00000,0.40884,2.52020,15.00000},
{5.76000,0.00233,0.12130,0.01654,0.99999,0.80000,1.00000,0.30000,2.70070,5.12390},
{4.20520,0.00100,0.20000,0.02000,1.00000,0.80000,1.06670,0.50000,3.50000,2000.00000},
{2.48870,0.00100,0.10000,0.02174,0.66814,1.06670,1.00000,0.60000,2.50000,15.00000},
{4.53210,0.00100,0.18889,0.02333,0.90365,0.80000,1.00000,0.18236,2.51440,15.00000},
{3.40890,0.00379,0.00000,0.01268,0.86446,0.61127,0.56861,0.54821,3.18250,12.20600},
{6.17170,0.00100,0.19001,0.02000,0.70086,0.99975,0.97166,0.30016,3.56110,14.44600},
{0.73618,0.00367,0.09944,0.02790,0.53847,1.03430,0.94742,0.41651,3.25870,14.57900},
{6.29530,0.00551,0.27137,0.02477,0.44766,0.69485,1.17840,0.53900,9.00780,21.42700},
{2.83890,0.00225,0.20000,0.03000,0.64475,1.00000,1.46200,0.60000,4.66660,30.00000},
{5.00000,0.00100,0.28605,0.01000,0.95833,0.40000,0.69931,0.33333,3.33330,20.00000},
{4.40970,0.01261,0.22994,0.02011,1.00460,0.80536,1.00600,0.29613,4.98960,20.04800},
{3.00000,0.01303,0.20000,0.02000,1.00000,0.62161,1.00000,0.40000,3.50000,15.00000},
{4.34310,0.00203,0.10604,0.01835,1.00000,0.80000,1.00000,0.20771,3.50000,20.00000},
{3.49230,0.00100,0.17816,0.01610,0.87157,1.06670,1.12740,-0.35765,2.93230,15.00000},
{3.00000,0.00357,0.18889,0.02231,1.00000,0.80000,1.00000,0.30000,2.50000,8.04790},
{7.35470,0.00500,0.02668,0.04000,0.50000,0.80000,0.88322,0.38956,5.00000,14.73600},
{4.21580,0.00100,0.09860,0.01679,1.00000,0.42067,0.58309,0.30000,2.50000,15.00000},
{2.03330,0.01000,0.15137,0.01000,0.25000,0.80000,1.44040,0.60000,4.66670,20.00000},
{4.91760,0.00167,0.22005,0.01992,1.00000,0.80000,0.78123,0.31111,2.59260,15.55600},
{6.92240,0.00100,0.21301,0.02000,1.05700,0.91356,0.77436,0.30000,3.33330,15.00000},
{7.00000,0.00500,0.08333,0.02000,0.37500,0.80000,1.00000,0.60000,3.73680,15.00000},
{9.99990,0.00100,0.04172,0.02000,1.00000,1.00000,1.00000,0.30000,5.00000,15.00000},
{5.09710,0.00100,0.20427,0.01492,0.44677,0.52681,0.98934,0.29481,3.34710,14.62700},
{1.07850,0.00100,0.00000,0.01667,0.53835,0.69188,1.34150,0.30396,2.81720,14.95100},
{1.45950,0.00357,0.04998,0.01000,0.49990,0.72361,1.00020,0.34341,3.90080,14.99800},
{2.85270,0.00458,0.09681,0.01934,0.50004,0.94845,0.95838,0.29995,6.10090,20.00100},
{4.65380,0.00100,0.20000,0.02000,1.00000,0.80000,0.87702,0.30000,3.33330,15.00000},
{1.50290,0.00293,0.18211,0.02003,0.44056,0.59206,1.30090,0.34047,6.55130,20.65400},
{5.00000,0.00100,0.10000,0.02000,1.00000,0.80000,1.00000,0.30000,3.33330,15.00000},
{10.00000,0.00100,0.21777,0.01484,0.37915,1.04010,0.81439,1.18340,7.04890,12.49500},
{9.99990,0.00770,0.20000,0.02000,0.50000,0.55190,1.00000,0.30000,7.00000,15.00000},
{2.51670,0.00100,0.04292,0.01000,0.48881,0.40000,1.10040,0.53554,3.33330,180.00000},
{5.48570,0.00414,0.30000,0.01000,0.44165,0.80000,1.00000,0.24940,5.00000,18.33300},
{6.30840,0.00412,0.21619,0.02000,0.87500,0.74892,1.00000,0.30000,4.81680,9.99990},
{5.27770,0.00100,0.16667,0.01000,0.50000,0.40000,1.24280,0.00001,3.50000,9.99990},
{7.67500,0.00100,0.09846,0.01000,0.99924,0.79506,1.67010,0.19655,3.31670,14.93900},
{9.99990,0.00100,0.10000,0.02000,2.03920,1.06670,1.06670,0.30000,2.50000,15.00000},
{2.42150,0.00100,0.20338,0.01193,0.46311,0.28359,1.04880,0.32555,7.25320,41.18200},
{8.87450,0.00409,0.10285,0.01857,0.33597,0.76088,1.09120,0.49594,4.71220,6.58720},
{2.90100,0.00388,0.14736,0.02792,0.52537,1.00300,1.05730,0.43405,7.11420,32.88500},
{3.29420,0.00612,0.00000,0.01000,1.00000,0.40000,1.00000,0.30000,3.50000,15.00000},
{4.18330,0.00100,0.10308,0.01000,0.51509,0.19629,1.17110,0.42075,3.50000,30.00000},
{9.99990,0.00100,0.04382,0.01833,0.50000,1.15490,1.00000,0.30000,2.50000,20.00000},
{4.52130,0.00100,0.10442,0.01000,0.77109,0.57201,1.42970,0.28827,3.45030,15.02700},
{4.91810,0.00100,0.18889,0.01944,0.49529,0.82500,1.02260,1.55910,5.04860,15.22200},
{7.52930,0.00100,0.16934,0.01809,1.10300,0.69410,1.23530,0.32604,3.14890,15.94100},
{8.43140,0.00154,0.10898,0.01000,1.51890,2.08900,0.54645,0.68550,2.84030,12.74600},
{4.50000,0.00400,0.10000,0.02000,0.50000,0.90679,1.25770,0.50000,3.50000,10.00000},
{5.19510,0.00100,0.19100,0.01949,0.44765,0.77692,1.12990,0.31666,3.55770,19.73100},
{2.55000,0.00100,0.10000,0.01600,0.25000,0.80000,1.00000,0.10870,3.50000,15.00000},
{5.22820,0.00100,0.14244,0.01737,0.78596,0.55484,1.10130,0.41109,4.55860,20.78800},
{4.22970,0.00100,0.13333,0.02000,0.76538,0.80000,0.80000,0.30000,2.60440,15.00000},
{8.84230,0.00100,0.06796,0.02961,1.00850,1.10320,0.99027,0.30632,2.85080,14.92200},
{10.00000,0.00100,0.09563,0.01000,0.25000,1.35520,1.46820,-0.02595,4.18060,10.74600},
{7.50000,0.00100,0.30000,0.02000,0.41667,0.40000,1.06580,0.19472,3.50000,15.00000},
{3.05870,0.00100,0.16667,0.01833,0.34286,0.69115,0.91667,0.24583,3.95520,14.33300},
{7.58490,0.00172,0.09965,0.01852,0.61256,0.77172,0.21043,0.51724,6.01010,14.98600},
{6.00000,0.00100,0.03958,0.01083,0.50000,0.62456,0.59038,0.36404,4.07740,10.00000},
{6.91100,0.00100,0.19061,0.01529,0.86824,0.86455,1.02040,0.29118,3.40470,14.86400},
{6.91100,0.00100,0.19061,0.01529,0.86824,0.86455,1.02040,0.29118,3.40470,14.86400},
{7.00000,0.00100,0.22180,0.02000,0.95833,0.24026,0.80000,0.60000,3.76090,9.06090},
{8.01800,0.00100,0.04954,0.01684,1.11510,0.79590,1.00030,0.39704,2.56530,14.96400},
{8.01800,0.00100,0.04954,0.01684,1.11510,0.79590,1.00030,0.39704,2.56530,14.96400},
{10.00000,0.00100,0.26573,0.03263,0.89275,0.66674,0.99245,0.50682,3.60510,16.31500},
{10.00000,0.00100,0.26573,0.03263,0.89275,0.66674,0.99245,0.50682,3.60510,16.31500},
{9.72510,0.00100,0.19475,0.02101,0.99762,0.81682,0.82726,0.24531,2.54600,15.23400},
{8.91330,0.00100,0.08701,0.01690,0.25000,1.25000,1.83610,0.12500,5.87500,12.56100},
{3.43280,0.00194,0.05926,0.01982,0.50000,0.80000,1.33330,1.35000,5.37040,28.43200},
{4.09650,0.00100,0.09815,0.02333,0.50000,0.80000,1.24190,0.30000,3.50000,13.12000},
{7.00000,0.00100,0.10000,0.02000,0.50000,0.80000,0.80000,0.19862,6.12390,20.00000},
{7.97020,0.00130,0.07253,0.02310,0.49586,0.39533,0.80598,0.46224,5.19330,10.08100},
{7.97020,0.00130,0.07253,0.02310,0.49586,0.39533,0.80598,0.46224,5.19330,10.08100},
{3.00000,0.00100,0.10000,0.01000,0.58333,0.69455,0.80000,0.50000,7.00000,20.00000},
{3.00000,0.00100,0.10000,0.01000,0.58333,0.69455,0.80000,0.50000,7.00000,20.00000},
{3.00000,0.00100,0.10000,0.01000,0.58333,0.69455,0.80000,0.50000,7.00000,20.00000},
{7.00000,0.00100,0.06952,0.01500,1.00000,0.38545,1.00000,0.60000,2.50000,15.00000},
{7.00000,0.00100,0.06952,0.01500,1.00000,0.38545,1.00000,0.60000,2.50000,15.00000},
{7.00000,0.00100,0.06952,0.01500,1.00000,0.38545,1.00000,0.60000,2.50000,15.00000},
{7.00000,0.00100,0.06952,0.01500,1.00000,0.38545,1.00000,0.60000,2.50000,15.00000},
{7.00000,0.00100,0.06952,0.01500,1.00000,0.38545,1.00000,0.60000,2.50000,15.00000},
{8.30060,0.00100,0.17500,0.01097,0.49194,0.74374,1.06250,0.34063,5.79690,15.50000},
{8.30060,0.00100,0.17500,0.01097,0.49194,0.74374,1.06250,0.34063,5.79690,15.50000},
{8.30060,0.00100,0.17500,0.01097,0.49194,0.74374,1.06250,0.34063,5.79690,15.50000},
{8.30060,0.00100,0.17500,0.01097,0.49194,0.74374,1.06250,0.34063,5.79690,15.50000},
{8.30060,0.00100,0.17500,0.01097,0.49194,0.74374,1.06250,0.34063,5.79690,15.50000},
{6.90390,0.00100,0.20000,0.02000,0.62499,0.48963,1.00000,0.30000,5.00000,15.00000},
{9.99990,0.00100,0.20291,0.01640,0.39246,1.02500,1.36220,0.13750,4.29230,17.00000},
{9.99990,0.00100,0.20291,0.01640,0.39246,1.02500,1.36220,0.13750,4.29230,17.00000},
{9.99990,0.00100,0.20291,0.01640,0.39246,1.02500,1.36220,0.13750,4.29230,17.00000},
{9.99990,0.00100,0.20291,0.01640,0.39246,1.02500,1.36220,0.13750,4.29230,17.00000},
{9.99990,0.00100,0.20291,0.01640,0.39246,1.02500,1.36220,0.13750,4.29230,17.00000},
{7.00000,0.00100,0.12994,0.02000,0.94787,0.71338,1.00000,-0.26226,3.89320,15.00000}};

struct pattern{
  uint64 pieces;
  uint64 pieces_empty;
  int n;
  double weight_act;
  double weight_pass;
  double drop_rate;
  int ind;
  pattern(uint64,uint64,int,double*,double*,double*,int);
  bool is_active(board&);
  bool contained(board&);
  bool contained(board&,bool);
  bool just_active(board&);
  bool isempty(uint64);
  uint64 missing_pieces(board&,bool);
  double diff_act_pass();
  void update(double*,double*,double*);
};

class heuristic{
  public:
    static const unsigned int Nweights=17;
    double center_weight;
    double w_act[Nweights];
    double w_pass[Nweights];
    double delta[Nweights];
    unsigned int Nfeatures;
    double D0,K0;
    double stopping_thresh,pruning_thresh,gamma,lapse_rate,opp_scale;
    double exploration_constant;
    bool self;
    int iterations;
    double tree_stats[4];
    vector<pattern> feature;
    vector<pattern> feature_backup;
    map<uint64,double> vtile;
    //vector<pattern> feature_backup2;
    mt19937_64 engine;
    geometric_distribution<int> iter_dist;
    normal_distribution<double> noise;
    bernoulli_distribution lapse;
    heuristic();
    void get_params_from_file(char*,int);
    void get_params_from_file(char*,int,int);
    void get_params_from_matlab(double*);
    void get_params(const double*);
    void get_features_from_file(char*);
    void addfeature(uint64, int );
    void addfeature(uint64, uint64, int , int );
    void update();
    void seed_generator(mt19937_64);
    void update_weights();
    double evaluate(board, zet);
    double evaluate(board);
    vector<zet> get_pruned_moves(board&, bool);
    vector<zet> get_moves(board&, bool, bool);
    zet makerandommove(board,bool);
    zet makemove_bfs(board,bool);
    int playout(board,bool);
    void remove_features();
    void restore_features();
    void eliminate_noise();
};

#endif // HEURISTIC_H_INCLUDED
